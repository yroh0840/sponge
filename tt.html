<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ã‚¸ãƒ£ãƒ³ãƒ—æ¤œå‡ºãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 40px; }
    button { padding: 10px 20px; font-size: 18px; }
    p { font-size: 20px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>ã‚¸ãƒ£ãƒ³ãƒ—æ¤œå‡ºãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰</h1>
  <button id="startBtn">é–‹å§‹</button>
  <p>çµæœã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>

  <script>
    let jumping = false;
    let jumpCount = 0;

    function startDetection() {
      if (typeof DeviceMotionEvent.requestPermission === "function") {
        // iOSã®å ´åˆã¯è¨±å¯ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        DeviceMotionEvent.requestPermission().then(response => {
          if (response === "granted") {
            window.addEventListener("devicemotion", handleMotion);
            console.log("ã‚¸ãƒ£ãƒ³ãƒ—æ¤œå‡ºé–‹å§‹ï¼");
          } else {
            console.log("ã‚»ãƒ³ã‚µãƒ¼åˆ©ç”¨ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ");
          }
        });
      } else {
        // Androidãªã©ã¯ãã®ã¾ã¾ä½¿ãˆã‚‹
        window.addEventListener("devicemotion", handleMotion);
        console.log("ã‚¸ãƒ£ãƒ³ãƒ—æ¤œå‡ºé–‹å§‹ï¼");
      }
    }

    function handleMotion(e) {
      const z = e.accelerationIncludingGravity.z;

      if (!jumping && Math.abs(z) < 2) {
        // å®™ã«æµ®ã„ãŸï¼
        jumping = true;
        console.log("ã‚¸ãƒ£ãƒ³ãƒ—ä¸­ï¼ğŸ•´ï¸");
      }

      if (jumping && Math.abs(z) > 15) {
        // ç€åœ°ã—ãŸï¼
        jumpCount++;
        console.log("ã‚¸ãƒ£ãƒ³ãƒ—å›æ•°:", jumpCount);
        jumping = false;
      }
    }

    document.getElementById("startBtn").addEventListener("click", startDetection);
  </script>
</body>
</html>
